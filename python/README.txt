README.txt
2011-02-22
Josef Novak

DESCRIPTION:
This directory contains python prototypes suitable for constructing 
a variety of useful WFST models. Cascades should work in both TCubed
and Juicer WFST decoders.

silclass2fst.py 
  - Build a silence class model from a wordlist

arpa2fst.py 
  - Build a WFST from a standard ARPA-format N-gram model
    NOTE: The python prototype ignores missing back-off NODES.
          These generally only occur in large interpolated or 
          heavily pruned models and even then seem to make
          little difference to WER.  
	  Missing back-off WEIGHTS are handled by creating
	  default back-off arcs with a Semiring('0.0') weight.
	  
	  Probably not all that important, but the C++ versions 
	  handle both issues, and also include an 'exact construction'
	  for standard epsilon arcs. 

lexicon2fst.py
  - Build a pronunciation lexicon WFST from a pronunciation dictionary.
    Input should be one entry per line, 
    ----------------
      WORD\tw er d 
    ----------------
    NOTE: Only builds the simplest generic lexicon.  C++ version includes 
          a variety of additional options.

cd2fst.py 
  - Build a context dependency transducer from a monophone list, an
    auxiliary symbols list (both generated by lexicon2fst.py) and an
    HTK format tiedlist to map logical->physical triphones
    NOTE: Builds an inverted, deterministic triphone transducer with 
          explicit auxiliary symbol loops and performs the HTK 
	  tiedlist mapping by default.
          The C++ version is much more flexible and supports any 
	  Combination of the properties:
          * Deterministic +/-
          * Explicit auxiliary symbols +/-

REQUIREMENTS:
Python >= 2.5. Not sure about Python3.
No other package depedencies.

The cascade generation bash scripts expect the OpenFST tools to be 
in the ${PATH} variable.
The juicer-test.sh bash script expects the juicer WFST decoder to be 
in the ${PATH} variable.


TESTING:
A set of simple models are available for testing the installation.
From the directory this README.txt file is in, download the following files:

----------------
Download the test files:

HTK hmmdefs file ~= 100MB
$ wget http://www.gavo.t.u-tokyo.ac.jp/~novakj/hmmdefs.gz
HTK tiedlist file
$ wget http://www.gavo.t.u-tokyo.ac.jp/~novakj/tiedlist.gz
2-gram ARPA LM for the WSJ data
$ wget http://www.gavo.t.u-tokyo.ac.jp/~novakj/bcb05cnp-2g.arpa.gz
Corresponding pronunciation dictionary
$ wget http://www.gavo.t.u-tokyo.ac.jp/~novakj/bcb05cnp-2g-htk.dic.gz
Two test .mfc files from the WSJ corpus to be used to sanity check the 
results of the build process.
$ wget http://www.gavo.t.u-tokyo.ac.jp/~novakj/jtune.tgz

----------------
Unpack everything

$ gunzip hmmdefs.gz
$ gunzip tiedlist.gz
$ gunzip bcb05cnp-2g.arpa.gz
$ gunzip bcb05cnp-2g-htk.dic.gz
$ tar -xvzf jtune.tgz

----------------
Run the build scripts
-Without silence class model
$ ./make-cascade-clg.sh bcb05cnp-2g.arpa bcb05cnp-2g-htk.dic test-clg hmmdefs tiedlist
-With silence class model
$ ./make-cascade-clgt.sh bcb05cnp-2g.arpa bcb05cnp-2g-htk.dic test-clgt hmmdefs tiedlist

----------------
Run the juicer decoding test

$ ./juicer-test.sh test-clg.clg.fst.txt bcb05cnp-2g-htk.dic test-clg.word.syms test-clg.hmm.syms hmmdefs

$ ./juicer-test.sh test-clgt.clgt.fst.txt bcb05cnp-2g-htk.dic test-clgt.word.syms test-clgt.hmm.syms hmmdefs

The above script should produce the following results (the first line is just a log message):
<s> 39 GetArraySize </s>
<s> GASOLINE PONT PRICES PLUNGED AN AVERAGE OF NEARLY NINE CENTS A GALLON OVER THE LAST WEEK ONE COULD DROP THE BIT MORE BECAUSE OF WEAKENING DEMAND IN EXCESS SUPPLIES </s>
<s> THE DECLINE IN THE AVERAGE PRICE OF SELF SERVICE REGULAR UNLEADED IT IS THE BIGGEST DECLINE SINCE THE YEAR AT T. AND VISION OF COOL WAIT AUGUST SECOND PACT </s>

The reference transcriptions are:
<s> GASOLINE PUMP PRICES PLUNGED AN AVERAGE OF NEARLY NINE CENTS A GALLON OVER THE LAST WEEK AND COULD DROP A BIT MORE BECAUSE OF WEAKENING DEMAND AND EXCESS SUPPLIES </s> (4o6c0i01)
<s> THE DECLINE IN THE AVERAGE PRICE OF SELFSERVICE REGULAR UNLEADED IS THE BIGGEST DECLINE SINCE THE IRAQI INVASION OF KUWAIT AUGUST SECOND </s> (4o6c0i02)

Note however, that 'PUMP', 'IRAQI', and 'KUWAIT' are all OOVs with respect to the reference models.  
The compound word SELFSERVICE is also an OOV but we are able to recover because the component tokens,
SELF and SERVICE are included in the reference vocabulary.
